# ðŸ”¹ What is MapStruct?

**MapStruct** is a **Java annotation-based code generator** used for **mapping one Java object to another** (mainly **DTO â†” Entity**).

âž¡ï¸ It generates **compile-time mapping code** (not runtime reflection).

---

# ðŸ”¹ Why do we use MapStruct?

### âŒ Problems without MapStruct

Manual mapping is:

```java
UserDTO dto = new UserDTO();
dto.setId(user.getId());
dto.setName(user.getName());
dto.setEmail(user.getEmail());
```

Issues:

* âŒ Too much **boilerplate code**
* âŒ Error-prone (missing fields)
* âŒ Hard to maintain when fields change
* âŒ Slower if reflection-based mappers are used

---

### âœ… Benefits of MapStruct

| Benefit             | Explanation                            |
| ------------------- | -------------------------------------- |
| ðŸš€ Fast             | No reflection â†’ pure Java code         |
| ðŸ›¡ï¸ Type-safe       | Compile-time errors if fields mismatch |
| ðŸ§¹ Clean code       | No manual setters                      |
| ðŸ”§ Easy maintenance | Field change â†’ compiler tells you      |
| ðŸ§ª Test-friendly    | Simple Java methods                    |

ðŸ‘‰ **Best for Spring Boot DTO â†” Entity mapping**

---

# ðŸ”¹ How MapStruct Works (Internally)

1. You define a **Mapper interface**
2. MapStruct **generates implementation at compile time**
3. Generated class uses **plain Java setter/getter calls**

ðŸ“Œ Example:

```java
UserMapper mapper = Mappers.getMapper(UserMapper.class);
```

---

# ðŸ”¹ Commonly Used MapStruct Annotations

## 1ï¸âƒ£ `@Mapper`

Marks an interface as a MapStruct mapper.

```java
@Mapper
public interface UserMapper {
}
```

For Spring Boot:

```java
@Mapper(componentModel = "spring")
```

---

## 2ï¸âƒ£ `@Mapping`

Maps fields when:

* Field names are different
* Custom transformation needed

```java
@Mapping(source = "emailAddress", target = "email")
```

---

## 3ï¸âƒ£ `@Mappings` (Optional in new versions)

Used to group multiple mappings (older style).

```java
@Mappings({
   @Mapping(source = "firstName", target = "name"),
   @Mapping(source = "emailId", target = "email")
})
```

---

## 4ï¸âƒ£ `@MappingTarget`

Used for **updating existing objects** (PATCH use-case).

```java
void updateUser(UserDTO dto, @MappingTarget User entity);
```

---

## 5ï¸âƒ£ `@InheritInverseConfiguration`

Auto-reverse mapping.

```java
@InheritInverseConfiguration
User dtoToEntity(UserDTO dto);
```

---

## 6ï¸âƒ£ `@Named`

Used with `qualifiedByName` for custom methods.

```java
@Named("toUpper")
```

---

## 7ï¸âƒ£ `@AfterMapping` / `@BeforeMapping`

For extra logic.

```java
@AfterMapping
default void after(UserDTO dto, @MappingTarget User user) {
    user.setUpdatedAt(LocalDateTime.now());
}
```

---

# ðŸ”¹ Complete Working Example (Proper Syntax)

---

## ðŸ”¸ Entity

```java
@Entity
public class User {

    private Long id;
    private String name;
    private String email;
    private int age;
}
```

---

## ðŸ”¸ DTO

```java
public class UserDTO {

    private Long userId;
    private String fullName;
    private String email;
}
```

---

## ðŸ”¸ Mapper Interface

```java
@Mapper(componentModel = "spring")
public interface UserMapper {

    @Mapping(source = "id", target = "userId")
    @Mapping(source = "name", target = "fullName")
    UserDTO toDto(User user);

    @InheritInverseConfiguration
    User toEntity(UserDTO dto);
}
```

ðŸ“Œ MapStruct auto-generates:

```java
UserMapperImpl
```

---

## ðŸ”¸ Usage in Service Layer

```java
@Service
public class UserService {

    private final UserMapper userMapper;

    public UserService(UserMapper userMapper) {
        this.userMapper = userMapper;
    }

    public UserDTO getUserDto(User user) {
        return userMapper.toDto(user);
    }
}
```

---

# ðŸ”¹ PATCH Update Example (Very Important for Interviews)

```java
@Mapper(componentModel = "spring")
public interface UserMapper {

    void updateUserFromDto(UserDTO dto, @MappingTarget User entity);
}
```

âœ” Updates only provided fields
âœ” Existing object remains intact

---

# ðŸ”¹ MapStruct vs ModelMapper (Interview Question)

| MapStruct               | ModelMapper     |
| ----------------------- | --------------- |
| Compile-time            | Runtime         |
| Faster                  | Slower          |
| Type-safe               | Not fully       |
| No reflection           | Uses reflection |
| Preferred in production | Mostly avoided  |

---

# ðŸ”¹ When NOT to Use MapStruct?

âŒ Very dynamic mappings
âŒ Mapping depends heavily on runtime logic

---

# ðŸ”¹ One-Line Interview Answer ðŸ’¡

> **MapStruct is a compile-time code generation library used to map DTOs and entities efficiently without reflection, providing high performance, type safety, and clean code.**
